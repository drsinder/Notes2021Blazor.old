function oktochatfunc(){$("#myChatMessage").modal("hide");window.open(pathbase+"/Home/Chat/"+document.getElementById("oktochat").innerHTML+"?id2=false")}function sendChatMessage(){chatChannel.trigger("client-append-message",{username:$("#displayname").val(),message:$("#message").val()});var n=new Date;$("#discussion").append("<li><strong>"+htmlEncode($("#displayname").val())+"<\/strong> @ "+n.toLocaleTimeString()+" : <strong>"+htmlEncode($("#message").val())+"<\/strong><\/li>");$("#message").val("").focus()}function htmlEncode(n){return $("<div />").text(n).html()}var username=document.getElementById("notesusername"),pathbase=document.getElementById("pathbase").innerHTML,pusherkey=document.getElementById("pusherkey"),pushercluster=document.getElementById("pushercluster"),membercount=0,chatChannel;setInterval(function(){var n=document.getElementById("digitalclock"),t;n!==null&&(t=(new Date).toTimeString(),n.innerHTML=t)},1e3);var pusher=new Pusher(pusherkey.innerHTML,{authEndpoint:pathbase+"/Home/PusherAuth",encrypted:!0,cluster:pushercluster.innerHTML,forceTLS:!0}),channel=pusher.subscribe("notes-channel"),presence=pusher.subscribe("presence-channel"),privatechannel=pusher.subscribe("notes-data-"+username.innerHTML);channel.bind("sys_message_event",function(n){document.getElementById("sysmessage").innerHTML=n.message;$("#mySysMessage").modal("show")});channel.bind("import_status_message_event",function(n){var t=n.newmessage;document.getElementById("import_status").innerHTML=t});presence.bind("pusher:subscription_succeeded",function(n){n.each(function(n){window.add_member(n.id,n.info)})});presence.bind("pusher:member_added",function(n){window.add_member(n.id,n.info)});presence.bind("pusher:member_removed",function(n){window.remove_member(n.id,n.info)});presence.bind("chat_request_event",function(n){username!==null&&username.innerHTML===n.username&&(document.getElementById("oktochat").innerHTML=n.username,document.getElementById("sysmessagechat").innerHTML=n.message,$("#myChatMessage").modal("show"))});privatechannel.bind("update-time",function(n){var t=document.getElementById("homepagetime");t!==null&&(t.innerHTML=n.message)});chatChannel=pusher.subscribe("private-notes-chat-"+$("#displayname2").val());chatChannel.bind("show_chat_message_event",function(n){$("#discussion").append("<li><strong>"+htmlEncode(n.username)+"<\/strong>: "+htmlEncode(n.message)+"<\/li>")});chatChannel.bind("client-append-message",function(n){var t=new Date;$("#discussion").append("<li><strong>"+htmlEncode(n.username)+"<\/strong> @ "+t.toLocaleTimeString()+" : <strong>"+htmlEncode(n.message)+"<\/strong><\/li>")});$("#chatsendmessage").click(function(){sendChatMessage()});$("#message").keypress(function(n){var t=n.keyCode?n.keyCode:n.which;t==="13"&&sendChatMessage()});